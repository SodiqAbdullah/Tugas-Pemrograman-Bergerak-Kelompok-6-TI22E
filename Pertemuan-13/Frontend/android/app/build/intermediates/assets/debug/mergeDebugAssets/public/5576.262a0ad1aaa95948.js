"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5576],{5576(F,m,s){s.d(m,{RiwayatPage:()=>b});var d=s(467),o=s(7343),_=s(2200),c=s(2615),t=s(3664),u=s(8446),p=s(6991);function g(i,l){1&i&&(t.j41(0,"div",11),t.nrm(1,"ion-spinner",12),t.j41(2,"p",13),t.EFF(3,"Memuat data dari server..."),t.k0s()())}function f(i,l){if(1&i){const n=t.RV6();t.j41(0,"div",14),t.nrm(1,"ion-icon",15),t.j41(2,"h3",16),t.EFF(3,"Belum ada laporan"),t.k0s(),t.j41(4,"p",17),t.EFF(5,"Lakukan patroli pertama Anda!"),t.k0s(),t.j41(6,"ion-button",18),t.bIt("click",function(){c.eBV(n);const a=t.XpG();return c.Njj(a.kembali())}),t.EFF(7,"Mulai Patroli"),t.k0s()()}}function h(i,l){if(1&i&&(t.j41(0,"ion-item",26),t.nrm(1,"ion-icon",32),t.j41(2,"ion-label")(3,"p"),t.EFF(4),t.k0s()()()),2&i){const n=t.XpG().$implicit;t.R7$(4),t.JRh(n.no_resi)}}function k(i,l){if(1&i){const n=t.RV6();t.j41(0,"div",33)(1,"img",34),t.bIt("click",function(){c.eBV(n);const a=t.XpG().$implicit,r=t.XpG(2);return c.Njj(r.lihatFoto(a.foto))}),t.k0s(),t.j41(2,"p",35),t.EFF(3," Ketuk foto untuk memperbesar "),t.k0s()()}if(2&i){const n=t.XpG().$implicit;t.R7$(),t.Y8G("src",n.foto,t.B4B)}}function x(i,l){if(1&i&&(t.j41(0,"ion-card",21)(1,"ion-card-content")(2,"div",22)(3,"div")(4,"h2",23),t.EFF(5),t.k0s(),t.j41(6,"p",24),t.EFF(7),t.k0s()(),t.j41(8,"ion-badge",25),t.EFF(9),t.k0s()(),t.j41(10,"ion-item",26),t.nrm(11,"ion-icon",27),t.j41(12,"ion-label")(13,"p"),t.EFF(14),t.k0s()()(),t.j41(15,"ion-item",26),t.nrm(16,"ion-icon",28),t.j41(17,"ion-label")(18,"p"),t.EFF(19),t.k0s()()(),t.DNE(20,h,5,1,"ion-item",29),t.j41(21,"ion-item",26),t.nrm(22,"ion-icon",30),t.j41(23,"ion-label")(24,"p"),t.EFF(25),t.k0s()()(),t.DNE(26,k,4,1,"div",31),t.k0s()()),2&i){const n=l.$implicit,e=t.XpG(2);t.R7$(5),t.JRh(n.nama_lokasi),t.R7$(2),t.JRh(e.formatTanggal(n.created_at||"")),t.R7$(),t.Y8G("color","Dalam Jangkauan"===n.status?"success":"danger"),t.R7$(),t.Lme(" ","Dalam Jangkauan"===n.status?"\u2705":"\u26a0\ufe0f"," ",n.status," "),t.R7$(5),t.JRh(n.username),t.R7$(5),t.Lme("",null==n.latitude?null:n.latitude.toFixed(6),", ",null==n.longitude?null:n.longitude.toFixed(6)),t.R7$(),t.Y8G("ngIf",n.no_resi&&"-"!==n.no_resi),t.R7$(2),t.Y8G("color",n.jarak>100?"danger":"success"),t.R7$(3),t.SpI("Jarak: ",null==n.jarak?null:n.jarak.toFixed(1)," meter"),t.R7$(),t.Y8G("ngIf",n.foto)}}function y(i,l){if(1&i&&(t.j41(0,"ion-list",19),t.DNE(1,x,27,12,"ion-card",20),t.k0s()),2&i){const n=t.XpG();t.R7$(),t.Y8G("ngForOf",n.riwayat)}}function R(i,l){if(1&i){const n=t.RV6();t.j41(0,"div",36),t.bIt("click",function(){c.eBV(n);const a=t.XpG();return c.Njj(a.tutupFoto())}),t.nrm(1,"img",37),t.j41(2,"p",38),t.EFF(3,"Ketuk untuk menutup"),t.k0s()()}if(2&i){const n=t.XpG();t.R7$(),t.Y8G("src",n.fotoTerpilih,t.B4B)}}let b=(()=>{var i;class l{constructor(e,a,r){this.patrolService=e,this.alertController=a,this.router=r,this.riwayat=[],this.isLoading=!0}ngOnInit(){var e=this;return(0,d.A)(function*(){yield e.loadRiwayat()})()}loadRiwayat(){var e=this;return(0,d.A)(function*(){e.isLoading=!0;try{e.riwayat=yield e.patrolService.getRiwayat()}catch(a){const r=a?.error?.error||a?.message||"Cek koneksi ke server.";yield(yield e.alertController.create({header:"Gagal Memuat",message:r,buttons:["OK"]})).present()}finally{e.isLoading=!1}})()}formatTanggal(e){return e?new Date(e).toLocaleString("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}lihatFoto(e){this.fotoTerpilih=e}tutupFoto(){this.fotoTerpilih=void 0}kembali(){this.router.navigate(["/home"])}static#t=i=()=>(this.\u0275fac=function(a){return new(a||l)(t.rXU(u.c),t.rXU(o.hG),t.rXU(p.Ix))},this.\u0275cmp=t.VBU({type:l,selectors:[["app-riwayat"]],decls:15,vars:4,consts:[["color","primary"],["slot","start"],["defaultHref","/home"],["name","time-outline",2,"margin-right","5px"],["slot","end"],["title","Refresh",3,"click"],["name","refresh"],["style","text-align:center; padding:50px 20px;",4,"ngIf"],["style","text-align:center; padding:60px 20px;",4,"ngIf"],["lines","none","style","padding:10px;",4,"ngIf"],["class","foto-modal",3,"click",4,"ngIf"],[2,"text-align","center","padding","50px 20px"],["name","crescent","color","primary"],[2,"color","gray","margin-top","10px"],[2,"text-align","center","padding","60px 20px"],["name","document-outline",2,"font-size","64px","color","#ccc"],[2,"color","#999"],[2,"color","#bbb"],["fill","outline",3,"click"],["lines","none",2,"padding","10px"],["class","riwayat-card",4,"ngFor","ngForOf"],[1,"riwayat-card"],[1,"card-header"],[1,"nama-lokasi"],[1,"waktu"],[3,"color"],["lines","none",1,"detail-item"],["name","person-outline","slot","start","color","medium","size","small"],["name","location-outline","slot","start","color","primary","size","small"],["lines","none","class","detail-item",4,"ngIf"],["name","resize-outline","slot","start","size","small",3,"color"],["style","margin-top:8px;",4,"ngIf"],["name","barcode-outline","slot","start","color","secondary","size","small"],[2,"margin-top","8px"],["alt","Foto bukti patroli",1,"foto-thumbnail",3,"click","src"],[2,"text-align","center","font-size","0.75rem","color","#999","margin","4px 0 0 0"],[1,"foto-modal",3,"click"],[1,"foto-fullscreen",3,"src"],[1,"foto-hint"]],template:function(a,r){1&a&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-title"),t.nrm(5,"ion-icon",3),t.EFF(6," Riwayat Patroli "),t.k0s(),t.j41(7,"ion-buttons",4)(8,"ion-button",5),t.bIt("click",function(){return r.loadRiwayat()}),t.nrm(9,"ion-icon",6),t.k0s()()()(),t.j41(10,"ion-content"),t.DNE(11,g,4,0,"div",7)(12,f,8,0,"div",8)(13,y,2,1,"ion-list",9)(14,R,4,1,"div",10),t.k0s()),2&a&&(t.R7$(11),t.Y8G("ngIf",r.isLoading),t.R7$(),t.Y8G("ngIf",!r.isLoading&&0===r.riwayat.length),t.R7$(),t.Y8G("ngIf",!r.isLoading&&r.riwayat.length>0),t.R7$(),t.Y8G("ngIf",r.fotoTerpilih))},dependencies:[o.bv,o.In,o.Jm,o.QW,o.b_,o.I9,o.W9,o.eU,o.iq,o.uz,o.he,o.nf,o.w2,o.BC,o.ai,o.el,_.MD,_.Sq,_.bT],styles:["ion-content[_ngcontent-%COMP%]{--background: #f4f5f8}.riwayat-card[_ngcontent-%COMP%]{border-radius:12px;margin-bottom:12px;box-shadow:0 2px 8px #00000014}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px;gap:8px}.card-header[_ngcontent-%COMP%]   .nama-lokasi[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;margin:0}.card-header[_ngcontent-%COMP%]   .waktu[_ngcontent-%COMP%]{font-size:.78rem;color:#999;margin:3px 0 0}.detail-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;--min-height: 28px}.detail-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;color:#555}.foto-thumbnail[_ngcontent-%COMP%]{width:100%;border-radius:8px;cursor:pointer;border:1px solid #ddd;object-fit:cover;max-height:200px}.foto-modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000eb;z-index:9999;display:flex;flex-direction:column;justify-content:center;align-items:center}.foto-fullscreen[_ngcontent-%COMP%]{max-width:95%;max-height:85vh;border-radius:8px;object-fit:contain}.foto-hint[_ngcontent-%COMP%]{color:#fff9;font-size:.8rem;margin-top:12px}"]}))}return i(),l})()}}]);